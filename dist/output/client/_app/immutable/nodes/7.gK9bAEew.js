import{a as z,t as A}from"../chunks/disclose-version.CCpMAAFc.js";import"../chunks/legacy.BWim2NN6.js";import{p as J,a as M,g as e,s as l,t as T,m as b,c as n,b as r,r as i,n as N,E as U}from"../chunks/runtime.BL0abR6R.js";import{e as $,s as B}from"../chunks/render.CxwJUUM4.js";import{F as G,a as H,b as K}from"../chunks/FormSearch.BTfTaHCP.js";import{i as Q}from"../chunks/lifecycle.DtcGbrmE.js";import{L as V}from"../chunks/Layout.BjnZ7Ewd.js";var W=A('<div><!> <!> <div class="pagination-container flex justify-between items-center mt-4 svelte-qw2lxv"><div class="flex items-center"><label for="itemsPerPage" class="mr-2 text-lightText dark:text-darkText">每页显示</label> <select id="itemsPerPage" class="p-2 border border-borderLight dark:border-borderDark rounded svelte-qw2lxv"><option>5</option><option>10</option><option>20</option><option>50</option></select> <span class="ml-2 text-lightText dark:text-darkText">条</span></div> <div class="pagination-buttons flex items-center"><button class="btn-pagination svelte-qw2lxv">上一页</button> <span class="mx-4 text-lightText dark:text-darkText"> </span> <button class="btn-pagination svelte-qw2lxv">下一页</button></div></div></div>');function se(E,F){J(F,!1);let L=[{label:"用户名",key:"username",sortable:!0},{label:"邮箱",key:"email",sortable:!0},{label:"角色",key:"role",sortable:!1},{label:"创建时间",key:"created_at",sortable:!0}],c=b([]),g=b(0),C=null,o=b(1),d=b(5),D=[{key:"username",label:"用户名"},{key:"email",label:"邮箱"}];C=(t=>{const s=document.cookie.match(new RegExp(`(^| )${t}=([^;]+)`));return s?decodeURIComponent(s[2]):null})("auth_token");const h=async()=>{try{const t=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:C},body:JSON.stringify({page:e(o),limit:e(d)})});if(!t.ok)throw new Error(`Failed to fetch data from /api/users: ${t.status}`);const s=await t.json();l(c,s.users.map(a=>({id:a.id,username:a.username,email:a.email,role:a.role,created_at:new Date(a.created_at).toLocaleString()}))),l(g,s.total)}catch(t){console.error("Error fetching user data:",t)}},_=t=>{l(o,t),h()},O=t=>{const s=t.detail;l(c,e(c).filter(a=>Object.entries(s).every(([v,p])=>{var u;return p===""||((u=a[v])==null?void 0:u.includes(p))}))),l(g,e(c).length),l(o,1),h()};h(),Q(),V(E,{children:(t,s)=>{var a=W(),v=n(a);G(v,{searchParams:D,$$events:{search:O}});var p=r(v,2);H(p,{columns:L,get rows(){return e(c)}});var u=r(p,2),f=n(u),m=r(n(f),2);T(()=>{e(d),U(()=>{})});var x=n(m);x.value=(x.__value="5")==null?"":"5";var k=r(x);k.value=(k.__value="10")==null?"":"10";var y=r(k);y.value=(y.__value="20")==null?"":"20";var S=r(y);S.value=(S.__value="50")==null?"":"50",i(m),N(2),i(f);var j=r(f,2),w=n(j),P=r(w,2),I=n(P);i(P);var q=r(P,2);T(()=>q.disabled=e(o)>=Math.ceil(e(g)/e(d))),i(j),i(u),i(a),T(()=>{w.disabled=e(o)<=1,B(I,`第 ${e(o)??""} 页`)}),K(m,()=>e(d),R=>l(d,R)),$("change",m,()=>_(1)),$("click",w,()=>_(e(o)-1)),$("click",q,()=>_(e(o)+1)),z(t,a)},$$slots:{default:!0}}),M()}export{se as component};
